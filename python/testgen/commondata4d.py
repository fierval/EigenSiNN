import torch
import torch.nn as nn

device = torch.device("cpu")
torch.set_printoptions(precision=8)

nhwc = (0, 2, 3, 1)

inp = torch.tensor([[[[0.04538226, 0.95949411, 0.50452268, 0.59602135],
          [0.74790466, 0.73222357, 0.07335120, 0.85607505],
          [0.90876633, 0.47080678, 0.24576986, 0.59051216],
          [0.29745585, 0.98773926, 0.62964255, 0.36631453]],

         [[0.50406832, 0.42415136, 0.34337270, 0.72482306],
          [0.46068907, 0.96129739, 0.62765759, 0.27029365],
          [0.35458261, 0.38653296, 0.47089547, 0.82289129],
          [0.63725311, 0.29671627, 0.54370487, 0.87211448]],

         [[0.85018283, 0.75999165, 0.15591985, 0.40320259],
          [0.74964321, 0.10842186, 0.55331987, 0.58271384],
          [0.67342269, 0.74921608, 0.96604007, 0.26602185],
          [0.53013945, 0.98281318, 0.43664277, 0.76730776]]],


        [[[0.61419797, 0.84584051, 0.52509171, 0.18094194],
          [0.38709599, 0.25413889, 0.74516875, 0.27006137],
          [0.72085720, 0.84589291, 0.62312174, 0.93618810],
          [0.64560336, 0.61316019, 0.96158671, 0.92482752]],

         [[0.11359078, 0.84837216, 0.81256318, 0.98481309],
          [0.36437154, 0.10838908, 0.87681556, 0.37505645],
          [0.05423701, 0.66477776, 0.46080470, 0.09901488],
          [0.24049366, 0.78823119, 0.09643930, 0.77357787]],

         [[0.92674822, 0.49461865, 0.82311010, 0.50724411],
          [0.43091267, 0.64998370, 0.53645664, 0.69436163],
          [0.01849866, 0.22924691, 0.96253598, 0.99673647],
          [0.09387362, 0.86051500, 0.52929527, 0.41473496]]]], device=device, dtype=torch.float,
       requires_grad=True) 

fakeloss = torch.tensor([[[[0.03411579, 0.30640966, 0.19440770, 0.00902396],
          [0.87998140, 0.08524799, 0.20483696, 0.11298430],
          [0.33172631, 0.01118428, 0.81524986, 0.33781791],
          [0.72575861, 0.48591703, 0.83571565, 0.74452734]],

         [[0.99675554, 0.52758676, 0.70237589, 0.33300936],
          [0.18728876, 0.86973250, 0.55728424, 0.77503520],
          [0.90626729, 0.46376646, 0.63194448, 0.14518911],
          [0.89655298, 0.54174763, 0.61954391, 0.52469307]],

         [[0.73198414, 0.08069026, 0.49224281, 0.47842449],
          [0.98264766, 0.13089573, 0.07510883, 0.34220546],
          [0.08220178, 0.48254997, 0.63483059, 0.02323723],
          [0.77521580, 0.24670333, 0.50362766, 0.62766153]]],


        [[[0.98965490, 0.88055056, 0.92259568, 0.24774176],
          [0.72176152, 0.90675122, 0.08763289, 0.57801038],
          [0.17916220, 0.27972364, 0.25751638, 0.81748664],
          [0.56826556, 0.73269165, 0.31478405, 0.95569855]],

         [[0.51677078, 0.98813075, 0.33273274, 0.64959395],
          [0.08583117, 0.13452137, 0.38807088, 0.40816027],
          [0.35822779, 0.15018040, 0.96034634, 0.90043443],
          [0.91827869, 0.20131719, 0.65043378, 0.43243688]],

         [[0.91697454, 0.39756697, 0.30185652, 0.28277457],
          [0.81693399, 0.69717938, 0.09399003, 0.18187153],
          [0.63124579, 0.38466102, 0.76345491, 0.11254698],
          [0.19470620, 0.97134984, 0.39794821, 0.64935327]]]], device=device, dtype=torch.float)

convloss = torch.tensor([[[[0.71517307, 0.11383849, 0.85747772, 0.51508510],
          [0.64379102, 0.95820493, 0.17088336, 0.31418425],
          [0.51001382, 0.68141299, 0.01387662, 0.74760181],
          [0.42009783, 0.05057448, 0.85066706, 0.79682261]],

         [[0.07949364, 0.69258714, 0.97440767, 0.10295397],
          [0.86574244, 0.37532806, 0.46254259, 0.29446429],
          [0.47950882, 0.97739607, 0.56291628, 0.87349355],
          [0.71772230, 0.46286476, 0.52409804, 0.22722328]],

         [[0.86859930, 0.91429222, 0.97574854, 0.22608805],
          [0.98486769, 0.52053684, 0.12926042, 0.49088836],
          [0.78483766, 0.88138652, 0.09527272, 0.29994535],
          [0.54592973, 0.87968433, 0.21275681, 0.97135520]],

         [[0.86198610, 0.06607985, 0.22253811, 0.91684496],
          [0.53806269, 0.88600296, 0.85361278, 0.95999491],
          [0.80940306, 0.95039427, 0.34645927, 0.24810839],
          [0.38775992, 0.44299924, 0.88993144, 0.48899335]],

         [[0.42266202, 0.01817179, 0.85047066, 0.72350872],
          [0.93015814, 0.22785562, 0.94849855, 0.35700458],
          [0.10637313, 0.04214853, 0.13525975, 0.72021925],
          [0.04951227, 0.44675946, 0.58063281, 0.77928430]]],


        [[[0.56938195, 0.78977436, 0.64853638, 0.21284622],
          [0.90346748, 0.44626033, 0.48527586, 0.01639593],
          [0.23647404, 0.01820564, 0.17719299, 0.79936773],
          [0.42906690, 0.87555593, 0.34665376, 0.83197212]],

         [[0.29568720, 0.85033768, 0.48847872, 0.97183102],
          [0.89426124, 0.57186007, 0.38576257, 0.36233485],
          [0.46394873, 0.09547216, 0.66809791, 0.98124099],
          [0.88730901, 0.33223855, 0.15714067, 0.60207504]],

         [[0.91964799, 0.45155972, 0.68250471, 0.18119448],
          [0.35587186, 0.33934748, 0.53832161, 0.16655338],
          [0.39401704, 0.52831423, 0.16316897, 0.48976129],
          [0.05736482, 0.67348874, 0.88786668, 0.97824907]],

         [[0.04577786, 0.20939660, 0.80530399, 0.08275759],
          [0.08776259, 0.91653019, 0.59590751, 0.52753395],
          [0.55670929, 0.01539660, 0.83089375, 0.34999788],
          [0.27612633, 0.50785720, 0.49178493, 0.10209370]],

         [[0.46164298, 0.42179662, 0.01441681, 0.68255055],
          [0.96797401, 0.32093710, 0.46031296, 0.86163229],
          [0.83324516, 0.34087223, 0.94839799, 0.74594235],
          [0.30180979, 0.17371619, 0.48790348, 0.16656733]]]], 
          requires_grad=True, device=device)

convweights = torch.tensor([[[[0.73027867, 0.38850695, 0.77408355],
          [0.49297833, 0.90659672, 0.18836355],
          [0.04310435, 0.30909634, 0.00293785]],

         [[0.49081051, 0.87883854, 0.22793245],
          [0.19394869, 0.74816018, 0.78440493],
          [0.45378476, 0.95257068, 0.22738194]],

         [[0.41356409, 0.45724821, 0.24288720],
          [0.83653516, 0.42836541, 0.36886293],
          [0.98561019, 0.88817686, 0.48391497]]],


        [[[0.86350316, 0.96448332, 0.06198353],
          [0.95530832, 0.95722210, 0.75767708],
          [0.14234066, 0.24686331, 0.48784947]],

         [[0.07517987, 0.48688841, 0.18591839],
          [0.24511278, 0.50047857, 0.09139228],
          [0.97555739, 0.19958436, 0.97825253]],

         [[0.90035379, 0.78639597, 0.68752265],
          [0.52299327, 0.17531115, 0.21360350],
          [0.84026957, 0.55812812, 0.37416142]]],


        [[[0.02347732, 0.84262252, 0.65620863],
          [0.21216887, 0.40895957, 0.93928844],
          [0.11966574, 0.04948360, 0.27720475]],

         [[0.25084192, 0.57170177, 0.65008521],
          [0.52581978, 0.43699783, 0.65302229],
          [0.08914214, 0.60709846, 0.93634570]],

         [[0.67080891, 0.67866302, 0.48880851],
          [0.01020145, 0.80715001, 0.14512080],
          [0.92411852, 0.26756018, 0.30676693]]],


        [[[0.17910123, 0.34714842, 0.34882456],
          [0.33346462, 0.75892407, 0.95541811],
          [0.68276197, 0.25997961, 0.89379877]],

         [[0.90402716, 0.27238405, 0.78153652],
          [0.78123343, 0.53185731, 0.43548268],
          [0.40001965, 0.12694675, 0.58085465]],

         [[0.31509912, 0.89059222, 0.69820553],
          [0.11363745, 0.39980549, 0.98195344],
          [0.80481243, 0.03052139, 0.64525765]]],


        [[[0.85137045, 0.98315364, 0.27414405],
          [0.55130732, 0.12552744, 0.74503434],
          [0.02404851, 0.14670181, 0.27567273]],

         [[0.00645614, 0.91220778, 0.31516474],
          [0.59764630, 0.41346133, 0.03927219],
          [0.19605428, 0.46631879, 0.30185586]],

         [[0.20861250, 0.46367437, 0.20343071],
          [0.07243395, 0.84193242, 0.05789715],
          [0.08896810, 0.86906624, 0.00832963]]]],
          requires_grad=True, device=device)