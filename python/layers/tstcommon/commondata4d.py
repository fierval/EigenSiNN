import torch
import torch.nn as nn

device = torch.device("cpu")
torch.set_printoptions(precision=8)

nhwc = (0, 2, 3, 1)

inp = torch.tensor([[[[0.04538226, 0.95949411, 0.50452268, 0.59602135],
          [0.74790466, 0.73222357, 0.07335120, 0.85607505],
          [0.90876633, 0.47080678, 0.24576986, 0.59051216],
          [0.29745585, 0.98773926, 0.62964255, 0.36631453]],

         [[0.50406832, 0.42415136, 0.34337270, 0.72482306],
          [0.46068907, 0.96129739, 0.62765759, 0.27029365],
          [0.35458261, 0.38653296, 0.47089547, 0.82289129],
          [0.63725311, 0.29671627, 0.54370487, 0.87211448]],

         [[0.85018283, 0.75999165, 0.15591985, 0.40320259],
          [0.74964321, 0.10842186, 0.55331987, 0.58271384],
          [0.67342269, 0.74921608, 0.96604007, 0.26602185],
          [0.53013945, 0.98281318, 0.43664277, 0.76730776]]],


        [[[0.61419797, 0.84584051, 0.52509171, 0.18094194],
          [0.38709599, 0.25413889, 0.74516875, 0.27006137],
          [0.72085720, 0.84589291, 0.62312174, 0.93618810],
          [0.64560336, 0.61316019, 0.96158671, 0.92482752]],

         [[0.11359078, 0.84837216, 0.81256318, 0.98481309],
          [0.36437154, 0.10838908, 0.87681556, 0.37505645],
          [0.05423701, 0.66477776, 0.46080470, 0.09901488],
          [0.24049366, 0.78823119, 0.09643930, 0.77357787]],

         [[0.92674822, 0.49461865, 0.82311010, 0.50724411],
          [0.43091267, 0.64998370, 0.53645664, 0.69436163],
          [0.01849866, 0.22924691, 0.96253598, 0.99673647],
          [0.09387362, 0.86051500, 0.52929527, 0.41473496]]]], device=device, dtype=torch.float,
       requires_grad=True) 

convloss = torch.tensor([[[[0.52655923, 0.91497749],
          [0.55097681, 0.55695909]],

         [[0.38170123, 0.22313505],
          [0.90244251, 0.75970703]],

         [[0.94758117, 0.15442288],
          [0.83576518, 0.88915426]],

         [[0.50519013, 0.57455820],
          [0.56564820, 0.66149050]],

         [[0.40158027, 0.45649415],
          [0.78431153, 0.30682415]]],


        [[[0.11868435, 0.16316265],
          [0.94931650, 0.50302845]],

         [[0.92081302, 0.45813042],
          [0.27644420, 0.37698764]],

         [[0.53511274, 0.45706326],
          [0.88924468, 0.55211645]],

         [[0.00830925, 0.53979075],
          [0.05123097, 0.76055157]],

         [[0.84883726, 0.50166541],
          [0.81442124, 0.09462160]]]], 
          requires_grad=True, device=device)

convweights = torch.tensor([[[[0.73027867, 0.38850695, 0.77408355],
          [0.49297833, 0.90659672, 0.18836355],
          [0.04310435, 0.30909634, 0.00293785]],

         [[0.49081051, 0.87883854, 0.22793245],
          [0.19394869, 0.74816018, 0.78440493],
          [0.45378476, 0.95257068, 0.22738194]],

         [[0.41356409, 0.45724821, 0.24288720],
          [0.83653516, 0.42836541, 0.36886293],
          [0.98561019, 0.88817686, 0.48391497]]],


        [[[0.86350316, 0.96448332, 0.06198353],
          [0.95530832, 0.95722210, 0.75767708],
          [0.14234066, 0.24686331, 0.48784947]],

         [[0.07517987, 0.48688841, 0.18591839],
          [0.24511278, 0.50047857, 0.09139228],
          [0.97555739, 0.19958436, 0.97825253]],

         [[0.90035379, 0.78639597, 0.68752265],
          [0.52299327, 0.17531115, 0.21360350],
          [0.84026957, 0.55812812, 0.37416142]]],


        [[[0.02347732, 0.84262252, 0.65620863],
          [0.21216887, 0.40895957, 0.93928844],
          [0.11966574, 0.04948360, 0.27720475]],

         [[0.25084192, 0.57170177, 0.65008521],
          [0.52581978, 0.43699783, 0.65302229],
          [0.08914214, 0.60709846, 0.93634570]],

         [[0.67080891, 0.67866302, 0.48880851],
          [0.01020145, 0.80715001, 0.14512080],
          [0.92411852, 0.26756018, 0.30676693]]],


        [[[0.17910123, 0.34714842, 0.34882456],
          [0.33346462, 0.75892407, 0.95541811],
          [0.68276197, 0.25997961, 0.89379877]],

         [[0.90402716, 0.27238405, 0.78153652],
          [0.78123343, 0.53185731, 0.43548268],
          [0.40001965, 0.12694675, 0.58085465]],

         [[0.31509912, 0.89059222, 0.69820553],
          [0.11363745, 0.39980549, 0.98195344],
          [0.80481243, 0.03052139, 0.64525765]]],


        [[[0.85137045, 0.98315364, 0.27414405],
          [0.55130732, 0.12552744, 0.74503434],
          [0.02404851, 0.14670181, 0.27567273]],

         [[0.00645614, 0.91220778, 0.31516474],
          [0.59764630, 0.41346133, 0.03927219],
          [0.19605428, 0.46631879, 0.30185586]],

         [[0.20861250, 0.46367437, 0.20343071],
          [0.07243395, 0.84193242, 0.05789715],
          [0.08896810, 0.86906624, 0.00832963]]]],
          requires_grad=True, device=device)