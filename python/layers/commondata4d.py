import torch
import torch.nn as nn

device = torch.device("cpu")
torch.set_printoptions(precision=8)

nhwc = (0, 2, 3, 1)

inp = torch.tensor([[[[0.04538226, 0.95949411, 0.50452268, 0.59602135],
          [0.74790466, 0.73222357, 0.07335120, 0.85607505],
          [0.90876633, 0.47080678, 0.24576986, 0.59051216],
          [0.29745585, 0.98773926, 0.62964255, 0.36631453]],

         [[0.50406832, 0.42415136, 0.34337270, 0.72482306],
          [0.46068907, 0.96129739, 0.62765759, 0.27029365],
          [0.35458261, 0.38653296, 0.47089547, 0.82289129],
          [0.63725311, 0.29671627, 0.54370487, 0.87211448]],

         [[0.85018283, 0.75999165, 0.15591985, 0.40320259],
          [0.74964321, 0.10842186, 0.55331987, 0.58271384],
          [0.67342269, 0.74921608, 0.96604007, 0.26602185],
          [0.53013945, 0.98281318, 0.43664277, 0.76730776]]],


        [[[0.61419797, 0.84584051, 0.52509171, 0.18094194],
          [0.38709599, 0.25413889, 0.74516875, 0.27006137],
          [0.72085720, 0.84589291, 0.62312174, 0.93618810],
          [0.64560336, 0.61316019, 0.96158671, 0.92482752]],

         [[0.11359078, 0.84837216, 0.81256318, 0.98481309],
          [0.36437154, 0.10838908, 0.87681556, 0.37505645],
          [0.05423701, 0.66477776, 0.46080470, 0.09901488],
          [0.24049366, 0.78823119, 0.09643930, 0.77357787]],

         [[0.92674822, 0.49461865, 0.82311010, 0.50724411],
          [0.43091267, 0.64998370, 0.53645664, 0.69436163],
          [0.01849866, 0.22924691, 0.96253598, 0.99673647],
          [0.09387362, 0.86051500, 0.52929527, 0.41473496]]]], device=device, dtype=torch.float,
       requires_grad=True) 

convloss = torch.tensor([[[[0.52655923, 0.91497749],
          [0.55097681, 0.55695909]],

         [[0.38170123, 0.22313505],
          [0.90244251, 0.75970703]],

         [[0.94758117, 0.15442288],
          [0.83576518, 0.88915426]],

         [[0.50519013, 0.57455820],
          [0.56564820, 0.66149050]],

         [[0.40158027, 0.45649415],
          [0.78431153, 0.30682415]]],


        [[[0.11868435, 0.16316265],
          [0.94931650, 0.50302845]],

         [[0.92081302, 0.45813042],
          [0.27644420, 0.37698764]],

         [[0.53511274, 0.45706326],
          [0.88924468, 0.55211645]],

         [[0.00830925, 0.53979075],
          [0.05123097, 0.76055157]],

         [[0.84883726, 0.50166541],
          [0.81442124, 0.09462160]]]], 
          requires_grad=True, device=device)

convweights = torch.tensor([[[[0.73027867, 0.38850695, 0.77408355],
          [0.49297833, 0.90659672, 0.18836355],
          [0.04310435, 0.30909634, 0.00293785]],

         [[0.49081051, 0.87883854, 0.22793245],
          [0.19394869, 0.74816018, 0.78440493],
          [0.45378476, 0.95257068, 0.22738194]],

         [[0.41356409, 0.45724821, 0.24288720],
          [0.83653516, 0.42836541, 0.36886293],
          [0.98561019, 0.88817686, 0.48391497]]],


        [[[0.86350316, 0.96448332, 0.06198353],
          [0.95530832, 0.95722210, 0.75767708],
          [0.14234066, 0.24686331, 0.48784947]],

         [[0.07517987, 0.48688841, 0.18591839],
          [0.24511278, 0.50047857, 0.09139228],
          [0.97555739, 0.19958436, 0.97825253]],

         [[0.90035379, 0.78639597, 0.68752265],
          [0.52299327, 0.17531115, 0.21360350],
          [0.84026957, 0.55812812, 0.37416142]]],


        [[[0.02347732, 0.84262252, 0.65620863],
          [0.21216887, 0.40895957, 0.93928844],
          [0.11966574, 0.04948360, 0.27720475]],

         [[0.25084192, 0.57170177, 0.65008521],
          [0.52581978, 0.43699783, 0.65302229],
          [0.08914214, 0.60709846, 0.93634570]],

         [[0.67080891, 0.67866302, 0.48880851],
          [0.01020145, 0.80715001, 0.14512080],
          [0.92411852, 0.26756018, 0.30676693]]],


        [[[0.17910123, 0.34714842, 0.34882456],
          [0.33346462, 0.75892407, 0.95541811],
          [0.68276197, 0.25997961, 0.89379877]],

         [[0.90402716, 0.27238405, 0.78153652],
          [0.78123343, 0.53185731, 0.43548268],
          [0.40001965, 0.12694675, 0.58085465]],

         [[0.31509912, 0.89059222, 0.69820553],
          [0.11363745, 0.39980549, 0.98195344],
          [0.80481243, 0.03052139, 0.64525765]]],


        [[[0.85137045, 0.98315364, 0.27414405],
          [0.55130732, 0.12552744, 0.74503434],
          [0.02404851, 0.14670181, 0.27567273]],

         [[0.00645614, 0.91220778, 0.31516474],
          [0.59764630, 0.41346133, 0.03927219],
          [0.19605428, 0.46631879, 0.30185586]],

         [[0.20861250, 0.46367437, 0.20343071],
          [0.07243395, 0.84193242, 0.05789715],
          [0.08896810, 0.86906624, 0.00832963]]]],
          requires_grad=True, device=device)

output = torch.tensor([[[[8.07499599, 7.15045643],
          [8.10665131, 8.34483147]],

         [[8.02071381, 8.00105000],
          [8.59840012, 7.35615301]],

         [[6.69626856, 7.25886059],
          [6.52549410, 7.36144972]],

         [[7.71711254, 7.79385471],
          [7.57863665, 8.35054302]],

         [[4.88373852, 6.39871025],
          [6.30057812, 5.32863426]]],


        [[[6.96206522, 8.43159199],
          [6.83061934, 7.42829943]],

         [[7.35133839, 8.24567509],
          [6.70658684, 9.45665741]],

         [[7.29201412, 6.47322607],
          [5.90080023, 7.87053108]],

         [[7.74224997, 8.80599689],
          [7.81940365, 9.29077721]],

         [[5.80813217, 5.95706034],
          [4.77996397, 6.56961155]]]], requires_grad=True, device=device)

convlossTrans = torch.tensor([[[[4.96316135e-01, 7.92477548e-01, 2.34434783e-01, 7.97314763e-01],
          [6.76662564e-01, 1.48203552e-01, 5.71428001e-01, 3.01166713e-01],
          [7.00305104e-01, 4.28561628e-01, 7.42801428e-02, 8.81532192e-01],
          [3.04673910e-01, 3.53993177e-01, 1.17599070e-01, 8.69437218e-01]],

         [[9.05885875e-01, 2.32551992e-01, 1.86755955e-01, 3.37415576e-01],
          [8.11264038e-01, 9.02753174e-01, 3.91587615e-01, 8.12822819e-01],
          [5.10200918e-01, 1.26486242e-01, 1.09222770e-01, 3.31829488e-01],
          [3.97138834e-01, 3.33881140e-01, 6.52551651e-04, 1.46179676e-01]],

         [[6.60912216e-01, 3.51333380e-01, 4.79690671e-01, 7.14489520e-01],
          [6.17390513e-01, 1.12137735e-01, 4.44863498e-01, 7.75538087e-01],
          [3.09900880e-01, 3.72003973e-01, 8.11737478e-01, 5.52288294e-02],
          [3.34506273e-01, 6.66140974e-01, 1.87946141e-01, 4.89497185e-02]]],


        [[[7.58935153e-01, 6.21026754e-03, 7.17243075e-01, 7.56132364e-01],
          [2.66936660e-01, 8.25479746e-01, 7.18556583e-01, 9.49894786e-02],
          [8.74605358e-01, 1.81173682e-02, 4.03705597e-01, 7.27183282e-01],
          [3.47347796e-01, 9.74398255e-01, 3.21247935e-01, 5.51482439e-02]],

         [[1.07566714e-01, 5.21773636e-01, 3.98344398e-02, 8.64081383e-02],
          [4.15481865e-01, 8.48773718e-02, 6.67667329e-01, 9.21505690e-03],
          [8.25709224e-01, 5.29612780e-01, 9.04335856e-01, 1.08141601e-01],
          [4.77578640e-01, 1.84232593e-01, 3.65195215e-01, 5.71406722e-01]],

         [[4.53029513e-01, 8.19483995e-02, 8.61269891e-01, 8.93562376e-01],
          [9.71841991e-01, 7.83358514e-01, 6.11796319e-01, 7.09603429e-01],
          [6.33177161e-02, 3.55225801e-02, 1.05036139e-01, 2.38680005e-01],
          [7.75761962e-01, 9.98185873e-01, 4.25170600e-01, 7.67863750e-01]]]], requires_grad=True, device=device)           

bias = torch.tensor([0.84739649, -0.12377239,  0.26775572,  1.46730196, -0.84922099], requires_grad=True, device=device)          