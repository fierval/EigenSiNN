import torch
import torch.nn as nn

device = torch.device("cpu")
torch.set_printoptions(precision=8)

inp = torch.tensor([[[ 0.87322980, -1.48464823,  0.63184929,  0.38559973,  0.41274598,
         -0.70019668,  0.10707247,  2.51629639],
        [-1.58931327,  0.81226659, -1.80089319,  2.07474923, -0.18125945,
          1.04950535, -0.04078181, -0.32585117],
        [-0.23254025, -1.10632432, -1.68039930, -0.50875676, -0.70717221,
          0.24772950, -0.08923696,  0.60365528]]], device=device, dtype=torch.float,
       requires_grad=True)

fakeloss = torch.tensor([[0.36603546, 0.40687686, 0.87746394, 0.62148917, 0.86859787, 0.51380110,
         0.60315830, 0.00604892],
        [0.21118003, 0.13755852, 0.23697436, 0.16111487, 0.92154074, 0.52772647,
         0.00271451, 0.32741523],
        [0.35232794, 0.79406255, 0.54326051, 0.46549028, 0.16354656, 0.50212926,
         0.17194599, 0.52774191]], device=device, dtype=torch.float)

weights = torch.tensor([[ 0.30841491,  0.16301581,  0.05912393,  0.32572004, -0.00591815,
         -0.07333553,  0.16375038, -0.35274175],
        [ 0.19089887, -0.24521475,  0.27066174, -0.00526837, -0.18401390,
         -0.20650741, -0.28048125,  0.29642352],
        [-0.15496132,  0.15089461,  0.16939566, -0.25025240, -0.18078347,
         -0.07853529, -0.32877934,  0.19627282],
        [-0.28125578, -0.15781732, -0.32488498, -0.08520141, -0.27685770,
         -0.02988693,  0.18739149,  0.32216403]], requires_grad=True)
         
target = torch.zeros((3, 4))

target[0, 1] = 1
target[1, 3] = 1
target[2, 2] = 1

target_nonbinary = torch.tensor([1, 3, 2])