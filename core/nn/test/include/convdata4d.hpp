#pragma once

#include <unsupported/Eigen/CXX11/Tensor>
#include <device/device_tensor.hpp>

using namespace Eigen;
using namespace EigenSinn;

namespace EigenSinnTest {

  template<typename Device_ = ThreadPoolDevice>
  struct ConvDataWith1Padding {

    void init() {
      dweight.resize(kernelDims);
      dweight.setValues({ {{{ 0.58017814, -1.06652141,  0.24069875},
          {-1.13385689, -0.91008675, -0.53363705},
          { 0.58206719, -1.46770668, -0.28482556}},

         {{ 1.14365447,  1.59496629,  0.93263179},
          {-0.35658675, -3.41941285,  1.88479114},
          {-1.26252568, -1.89460456, -0.13087314}},

         {{ 1.63701570,  1.99365187,  1.23881710},
          { 1.75376832, -1.33144522, -0.44847119},
          {-1.66340327, -3.22782040,  0.93099791}}},


        {{{ 0.05685091,  3.62616897,  2.51740718},
          {-0.70520413,  2.35427833,  0.71326160},
          { 1.06774569,  1.21321487, -0.35234475}},

         {{ 1.01154315,  2.35975814,  1.42489624},
          {-2.60425043,  0.61160362, -0.25522089},
          { 0.73395383, -2.37928057, -0.38420022}},

         {{ 0.22870708,  0.20375609,  1.59503508},
          {-0.97911072, -1.49514186,  1.77571702},
          { 0.74661529, -0.39116073,  0.64815241}}},


        {{{ 2.38898993,  3.85088372,  4.73529291},
          { 2.26172638,  2.52631640,  2.32047272},
          { 2.91317368, -0.14008141,  3.47857952}},

         {{ 2.55664611,  3.13307714,  4.74736881},
          { 2.11760807,  0.91584867,  3.65293026},
          {-0.11964452,  2.71612120, -1.41442871}},

         {{ 3.31022048,  5.51988983,  1.79803324},
          { 0.55154240, -0.03661758,  3.59301329},
          {-0.13025105,  2.27116084,  2.93629718}}},


        {{{-4.93650198,  0.38209927,  0.82152092},
          {-3.73891139, -0.87809801,  1.56271744},
          {-3.93266010, -2.30084038,  1.27101910}},

         {{-4.01587677, -1.08600390, -0.19545364},
          {-2.67319083, -3.26249194,  0.64262581},
          {-3.82720757, -2.32612896,  1.43930900}},

         {{-0.40224534,  1.13637137, -1.30413020},
          {-3.07997584, -1.07991886,  0.25040150},
          {-4.69819164, -4.15266800, -0.77174413}}},


        {{{-1.47427702, -0.14041245, -1.57604897},
          { 0.32590479,  0.97091305,  2.70523882},
          {-0.30440041,  0.72179413,  3.67790246}},

         {{-3.37847185, -1.09789038,  2.09593201},
          {-3.88296652,  0.58865547,  5.35944748},
          { 0.31609765,  0.28727162,  2.59260821}},

         {{ 0.17146537, -1.11000216,  1.18338823},
          { 1.21788478,  1.41564703,  3.68813729},
          {-3.75258398, -0.15369980,  4.22451067}}} });

      convLoss.resize(convOutDims);
      convLoss.setValues({ {{{-1.42880991e-01, -1.79995820e-01, -2.23988816e-02, -1.27780569e+00},
          {-4.28983897e-01, -1.30506590e-01, -1.25400054e+00, -5.80857038e-01},
          { 2.41734743e-01, -5.61485231e-01,  9.16441619e-01, -6.85793638e-01},
          {-3.30635756e-01,  1.41633308e+00,  1.70194507e+00,  3.09154540e-01}},

         {{-1.07746220e+00,  5.34955800e-01, -9.41319466e-01, -1.44235253e-01},
          {-2.06587970e-01,  1.40823233e+00, -1.46839476e+00,  6.14254892e-01},
          {-1.43299091e+00,  8.96415055e-01,  3.16293776e-01, -6.54077649e-01},
          {-3.84440780e-01, -1.53746164e+00, -1.02851653e+00,  2.14020252e-01}},

         {{ 4.07129049e-01, -2.72242951e+00,  1.22277439e+00, -1.06981838e+00},
          {-4.37907994e-01,  1.18863344e+00,  2.15407282e-01,  1.80333185e+00},
          { 1.89356136e+00, -2.25679350e+00, -2.88884137e-02, -1.08591950e+00},
          { 6.70198798e-01,  5.29932320e-01,  5.79809546e-01,  9.92422551e-02}},

         {{ 1.30197990e+00, -5.56562126e-01,  1.17665589e+00, -6.98464930e-01},
          { 1.08148694e+00, -1.80579737e-01, -3.94287378e-01, -4.60451931e-01},
          { 2.14768481e+00, -1.84623528e+00, -1.24430823e+00, -5.14520168e-01},
          { 1.22344744e+00,  1.00172174e+00,  5.09753764e-01,  1.55777502e+00}},

         {{ 1.26048550e-01,  3.26698691e-01,  1.43882346e+00, -7.02858269e-01},
          { 7.77954161e-01, -1.06694186e+00, -1.45606220e+00, -1.57064450e+00},
          {-5.62893450e-01,  1.60254335e+00, -2.23917946e-01,  4.85453576e-01},
          { 8.39009583e-02,  1.08441293e+00,  8.79698753e-01, -9.25264418e-01}}},


        {{{-1.15476394e+00, -4.13120151e-01, -5.04229963e-01,  2.19234198e-01},
          {-7.78198183e-01,  1.05550909e+00,  6.52431548e-01,  2.62019839e-02},
          { 1.23122954e+00, -7.20014989e-01,  7.24939167e-01,  1.95647433e-01},
          { 3.35392922e-01, -1.86994576e+00,  2.59609371e-01, -6.73499048e-01}},

         {{ 1.01161933e+00,  3.97960603e-01, -2.26829886e+00, -1.81910068e-01},
          { 7.48132229e-01, -3.68831694e-01,  6.58229291e-01,  8.60950470e-01},
          { 6.83064997e-01,  9.41513956e-01,  2.94248074e-01, -6.20660901e-01},
          { 2.74032569e+00,  1.59173620e+00, -6.77763745e-02,  3.49216580e-01}},

         {{-1.09646320e+00, -7.57939696e-01,  1.90116972e-01,  4.95045662e-01},
          {-9.11865234e-01,  1.67767799e+00,  3.84205967e-01,  9.45953548e-01},
          { 2.29908869e-01,  1.97760952e+00, -2.19316870e-01,  5.21311045e-01},
          { 1.32812333e+00, -1.27944088e+00,  4.96444523e-01, -3.52660626e-01}},

         {{-1.22375405e+00,  8.59303415e-01, -1.16736257e+00, -9.98711944e-01},
          { 5.89706302e-01,  1.07087159e+00, -2.28283691e+00,  2.18185200e-03},
          { 7.01504409e-01, -1.38955474e+00,  5.18145621e-01,  7.11032629e-01},
          { 8.32042873e-01, -1.90843844e+00, -8.87253344e-01, -3.95677865e-01}},

         {{ 1.41728139e+00,  1.63288403e+00,  2.01275811e-01, -2.52648652e-01},
          { 3.05831641e-01,  2.07364726e+00,  4.19553548e-01, -1.45284212e+00},
          { 1.66041061e-01, -8.20718348e-01, -1.86936527e-01, -9.00231063e-01},
          { 2.01392740e-01,  8.24502856e-02, -2.43632913e+00,  1.11221468e+00}}} });

      dinput.resize(dims);
      dinput.setValues({ {{{ 0.46202406, -2.06735706, -7.58754015, -0.99987143},
          { 2.31908774,  3.12245536, -6.19215870, -3.09493637},
          { 3.32232666,  4.13152742, -0.53385520, -2.60052633},
          {-0.27906242,  3.57549262,  1.05781090,  1.30553114}},

         {{-0.85236526,  1.45662737, -5.45895481, -2.81842566},
          {-1.15788031, -1.35951185, -7.27877712, -4.44800854},
          { 2.50399137,  2.85383558,  1.84876215, -2.26271963},
          { 3.24384832,  3.95983005,  1.81764400,  1.12229586}},

         {{ 3.16691089, -1.79901373, -0.05027946, -2.57770324},
          {-1.34307849,  0.22400825, -8.94664383, -5.04543304},
          { 4.88495779,  1.79565358, -2.24934196, -2.48178673},
          {-2.26088786,  6.58914518,  0.10378288,  0.02724171}}},


        {{{ 2.52988863,  1.32168460,  0.92247051, -2.83629441},
          { 3.57396340,  5.13900852,  3.01928926, -2.28118062},
          { 7.62403584,  1.26727128, -1.46175349, -0.42873883},
          { 4.00187397,  1.82417548, -1.93097496, -2.29790020}},

         {{ 1.85568964, -0.43940938,  0.95067406, -2.79817533},
          { 3.48563790, -0.70801044,  2.84676290, -2.47128224},
          { 1.49052548,  4.47755718,  0.23096982, -0.02198215},
          { 2.30817556,  0.28586754, -2.17490029,  0.34708205}},

         {{ 1.85290873,  1.87484550,  2.31372380, -1.97837830},
          { 4.26311731,  3.65385294,  1.70212626, -3.12142920},
          { 7.30065823,  5.81000757,  0.42977920, -1.54213512},
          { 3.66221309,  1.58656967, -3.70428514, -0.66009647}}} });

      output.resize(convOutDims);
      output.setValues({ {{{3.18525815, 5.39516497, 4.83428144, 3.57407784},
          {5.81778145, 8.07499599, 7.15045643, 5.88217783},
          {5.61213350, 8.10665131, 8.34483147, 6.04232931},
          {3.36198282, 5.47193384, 6.07112598, 3.97875214}},

         {{3.40599775, 4.79820538, 5.18954515, 3.32985759},
          {4.92142153, 8.02071381, 8.00105000, 5.18146992},
          {5.18766975, 8.59840012, 7.35615301, 5.58307791},
          {3.87689734, 6.02004766, 5.71150637, 4.18156624}},

         {{3.86718392, 4.44522238, 3.48365140, 2.11355543},
          {5.78645658, 6.69626856, 7.25886059, 4.24670553},
          {5.83083439, 6.52549410, 7.36144972, 4.20731115},
          {4.44412804, 5.36810398, 5.04307699, 3.49467325}},

         {{4.04874420, 4.94895649, 5.03209257, 2.47438884},
          {5.87463522, 7.71711254, 7.79385471, 4.21720219},
          {6.50027037, 7.57863665, 8.35054302, 4.42463160},
          {4.81585217, 5.98447800, 5.87630558, 3.17313528}},

         {{3.17438745, 2.76113772, 2.99244285, 2.14072347},
          {4.09165525, 4.88373852, 6.39871025, 3.94958973},
          {4.43745136, 6.30057812, 5.32863426, 3.95341563},
          {3.48407722, 4.66475582, 3.97020483, 3.62465620}}},


        {{{3.23543549, 5.58041382, 6.09041500, 4.23934174},
          {3.46673274, 6.96206522, 8.43159199, 6.55308533},
          {3.62379456, 6.83061934, 7.42829943, 6.49796200},
          {3.05482292, 4.80923653, 6.39499474, 4.51616383}},

         {{2.51330328, 5.70995712, 4.76861000, 3.82756662},
          {4.24430609, 7.35133839, 8.24567509, 6.23800087},
          {4.49540949, 6.70658684, 9.45665741, 5.80343580},
          {2.54507709, 5.45657730, 6.48133802, 5.73851109}},

         {{3.19611025, 4.38010311, 4.74398279, 2.55077338},
          {4.62974644, 7.29201412, 6.47322607, 4.66571951},
          {4.35230684, 5.90080023, 7.87053108, 4.36465502},
          {3.41071081, 5.06746244, 5.79803181, 3.60895443}},

         {{3.42989707, 5.73156500, 5.22930813, 3.19761610},
          {5.44603682, 7.74224997, 8.80599689, 5.21809912},
          {4.91306925, 7.81940365, 9.29077721, 5.22068357},
          {3.68564463, 5.23530197, 6.66209984, 3.80639267}},

         {{2.30584192, 3.06413746, 3.56994796, 2.74720573},
          {3.11321926, 5.80813217, 5.95706034, 4.92343140},
          {2.64947629, 4.77996397, 6.56961155, 4.31383896},
          {2.05192661, 5.05881357, 4.96326876, 3.61839938}}} });

    // transposed convolutions
      output_trans.resize(dims);
      output_trans.setValues({ {{{18.65117455, 25.76638222, 24.67757988, 15.46115112},
          {18.83522415, 24.20661736, 23.82810020, 24.89949608},
          {18.42541122, 24.79121017, 24.62372398, 26.10604286},
          { 7.79095507,  7.53007221,  7.50948620, 14.03672028}},

         {{14.07884598, 22.85327339, 22.25931549, 15.59719849},
          {17.07781982, 19.10548019, 19.31698227, 14.99237537},
          {17.00071526, 19.85581589, 19.78628731, 14.95382023},
          {16.06950951, 16.61514854, 16.78828621, 21.90912056}},

         {{18.75525665, 24.56800270, 24.50413322, 17.64348984},
          {11.58931160, 17.46718597, 18.82797813, 13.52418709},
          {12.23796844, 18.58169937, 18.63098907, 13.58052921},
          {27.32052040, 17.92009354, 18.55744553, 13.98305321}}},


        {{{21.03252411, 21.50821304, 28.32283783, 13.61332321},
          {19.62783051, 22.93564987, 25.61514091, 25.45498657},
          {21.08591843, 21.55985069, 26.88098335, 22.94265747},
          { 8.46741390,  7.19245100,  8.12533855, 14.14933872}},

         {{14.77262592, 19.13207054, 24.15571976, 14.25744629},
          {17.49991989, 18.59373093, 20.41029930, 14.49449539},
          {19.08170700, 17.18067360, 21.38746643, 13.41719055},
          {17.13777351, 16.21733665, 17.50306320, 21.85270119}},

         {{21.16405487, 21.58222389, 27.49514580, 15.58630371},
          {12.86397743, 18.14227676, 18.81835365, 13.13534546},
          {12.77173519, 16.01521683, 20.43825531, 12.76347923},
          {28.83804512, 17.52154160, 19.26871681, 13.40070915}}} });

      convLossTrans.resize(dims);
      convLossTrans.setValues({ {{{4.96316135e-01, 7.92477548e-01, 2.34434783e-01, 7.97314763e-01},
          {6.76662564e-01, 1.48203552e-01, 5.71428001e-01, 3.01166713e-01},
          {7.00305104e-01, 4.28561628e-01, 7.42801428e-02, 8.81532192e-01},
          {3.04673910e-01, 3.53993177e-01, 1.17599070e-01, 8.69437218e-01}},

         {{9.05885875e-01, 2.32551992e-01, 1.86755955e-01, 3.37415576e-01},
          {8.11264038e-01, 9.02753174e-01, 3.91587615e-01, 8.12822819e-01},
          {5.10200918e-01, 1.26486242e-01, 1.09222770e-01, 3.31829488e-01},
          {3.97138834e-01, 3.33881140e-01, 6.52551651e-04, 1.46179676e-01}},

         {{6.60912216e-01, 3.51333380e-01, 4.79690671e-01, 7.14489520e-01},
          {6.17390513e-01, 1.12137735e-01, 4.44863498e-01, 7.75538087e-01},
          {3.09900880e-01, 3.72003973e-01, 8.11737478e-01, 5.52288294e-02},
          {3.34506273e-01, 6.66140974e-01, 1.87946141e-01, 4.89497185e-02}}},


        {{{7.58935153e-01, 6.21026754e-03, 7.17243075e-01, 7.56132364e-01},
          {2.66936660e-01, 8.25479746e-01, 7.18556583e-01, 9.49894786e-02},
          {8.74605358e-01, 1.81173682e-02, 4.03705597e-01, 7.27183282e-01},
          {3.47347796e-01, 9.74398255e-01, 3.21247935e-01, 5.51482439e-02}},

         {{1.07566714e-01, 5.21773636e-01, 3.98344398e-02, 8.64081383e-02},
          {4.15481865e-01, 8.48773718e-02, 6.67667329e-01, 9.21505690e-03},
          {8.25709224e-01, 5.29612780e-01, 9.04335856e-01, 1.08141601e-01},
          {4.77578640e-01, 1.84232593e-01, 3.65195215e-01, 5.71406722e-01}},

         {{4.53029513e-01, 8.19483995e-02, 8.61269891e-01, 8.93562376e-01},
          {9.71841991e-01, 7.83358514e-01, 6.11796319e-01, 7.09603429e-01},
          {6.33177161e-02, 3.55225801e-02, 1.05036139e-01, 2.38680005e-01},
          {7.75761962e-01, 9.98185873e-01, 4.25170600e-01, 7.67863750e-01}}} });

      weights.resize(kernelDims);
      weights.setValues({ {{{0.73027867, 0.38850695, 0.77408355},
          {0.49297833, 0.90659672, 0.18836355},
          {0.04310435, 0.30909634, 0.00293785}},

         {{0.49081051, 0.87883854, 0.22793245},
          {0.19394869, 0.74816018, 0.78440493},
          {0.45378476, 0.95257068, 0.22738194}},

         {{0.41356409, 0.45724821, 0.24288720},
          {0.83653516, 0.42836541, 0.36886293},
          {0.98561019, 0.88817686, 0.48391497}}},


        {{{0.86350316, 0.96448332, 0.06198353},
          {0.95530832, 0.95722210, 0.75767708},
          {0.14234066, 0.24686331, 0.48784947}},

         {{0.07517987, 0.48688841, 0.18591839},
          {0.24511278, 0.50047857, 0.09139228},
          {0.97555739, 0.19958436, 0.97825253}},

         {{0.90035379, 0.78639597, 0.68752265},
          {0.52299327, 0.17531115, 0.21360350},
          {0.84026957, 0.55812812, 0.37416142}}},


        {{{0.02347732, 0.84262252, 0.65620863},
          {0.21216887, 0.40895957, 0.93928844},
          {0.11966574, 0.04948360, 0.27720475}},

         {{0.25084192, 0.57170177, 0.65008521},
          {0.52581978, 0.43699783, 0.65302229},
          {0.08914214, 0.60709846, 0.93634570}},

         {{0.67080891, 0.67866302, 0.48880851},
          {0.01020145, 0.80715001, 0.14512080},
          {0.92411852, 0.26756018, 0.30676693}}},


        {{{0.17910123, 0.34714842, 0.34882456},
          {0.33346462, 0.75892407, 0.95541811},
          {0.68276197, 0.25997961, 0.89379877}},

         {{0.90402716, 0.27238405, 0.78153652},
          {0.78123343, 0.53185731, 0.43548268},
          {0.40001965, 0.12694675, 0.58085465}},

         {{0.31509912, 0.89059222, 0.69820553},
          {0.11363745, 0.39980549, 0.98195344},
          {0.80481243, 0.03052139, 0.64525765}}},


        {{{0.85137045, 0.98315364, 0.27414405},
          {0.55130732, 0.12552744, 0.74503434},
          {0.02404851, 0.14670181, 0.27567273}},

         {{0.00645614, 0.91220778, 0.31516474},
          {0.59764630, 0.41346133, 0.03927219},
          {0.19605428, 0.46631879, 0.30185586}},

         {{0.20861250, 0.46367437, 0.20343071},
          {0.07243395, 0.84193242, 0.05789715},
          {0.08896810, 0.86906624, 0.00832963}}} });

      dweight_trans.resize(kernelDims);
      dweight_trans.setValues({ {{{ 9.77927208, 13.75097466, 11.62840462},
          {19.42990494, 24.30498886, 15.20662880},
          { 5.10725260, 13.19183636,  7.40464735}},

         {{ 8.35850239,  7.30360413,  3.32553148},
          {19.69523811, 28.58226585, 10.05639648},
          { 6.86647224,  7.06257153,  5.15857124}},

         {{ 8.88043976, 13.80860329, 11.89570236},
          {15.66521168, 25.51109886, 13.28082561},
          { 8.93278122, 17.25728607,  5.74118662}}},


        {{{10.82796669, 15.36294937, 11.92669868},
          {21.03747940, 25.92465782, 15.57055664},
          { 5.30182838, 13.59223175,  7.37892056}},

         {{ 7.68105650,  7.24940109,  3.48073769},
          {21.47845840, 30.49809456, 10.16562557},
          { 7.11548615,  7.04882336,  5.37306929}},

         {{ 9.14591599, 15.24391174, 12.13622093},
          {15.83171844, 25.66363716, 13.51251221},
          { 9.07308292, 17.69051361,  6.03743792}}},


        {{{ 9.62682915, 12.57881737,  9.66465855},
          {18.67861176, 22.43878555, 12.75275421},
          { 4.46004629, 12.40890503,  6.22412682}},

         {{ 7.51524067,  6.28471136,  2.71168065},
          {18.83294868, 25.70061111,  8.31354904},
          { 5.97424984,  5.94791269,  5.14556456}},

         {{ 8.43085480, 13.08605576,  9.93513012},
          {13.55216789, 23.09204102, 12.13644791},
          { 7.44981718, 15.85594559,  5.92705345}}},


        {{{11.19560623, 14.67586327, 11.95506287},
          {21.59814453, 26.07660675, 15.42652130},
          { 5.43332767, 14.02129745,  7.13651609}},

         {{ 8.56401730,  7.77199221,  3.23281026},
          {21.91353989, 30.96914482,  9.70440865},
          { 7.30079842,  7.22396660,  5.55205870}},

         {{ 9.72797203, 15.31095982, 12.40198135},
          {16.54600143, 26.63637924, 13.76373672},
          { 9.43845081, 18.07776642,  6.32274342}}},


        {{{ 7.63059616, 10.98397732,  8.63782883},
          {15.39741325, 19.28995705, 11.05260277},
          { 4.01869202, 10.05441952,  4.56641245}},

         {{ 5.53380632,  5.21612215,  2.53894091},
          {15.80935669, 21.23639107,  6.63076639},
          { 5.38614082,  4.88030100,  4.03270912}},

         {{ 6.49798775, 10.81961823,  8.77289295},
          {11.80714607, 19.11769676,  9.39785004},
          { 6.76166916, 12.78623390,  4.69891167}}} });

      input_trans.resize(convInputTransDims);
      input_trans.setValues({ {{{8.07499599, 7.15045643},
          {8.10665131, 8.34483147}},

          {{8.02071381, 8.00105000},
          {8.59840012, 7.35615301}},

          {{6.69626856, 7.25886059},
          {6.52549410, 7.36144972}},

          {{7.71711254, 7.79385471},
          {7.57863665, 8.35054302}},

          {{4.88373852, 6.39871025},
          {6.30057812, 5.32863426}}},


        {{{6.96206522, 8.43159199},
          {6.83061934, 7.42829943}},

          {{7.35133839, 8.24567509},
          {6.70658684, 9.45665741}},

          {{7.29201412, 6.47322607},
          {5.90080023, 7.87053108}},

          {{7.74224997, 8.80599689},
          {7.81940365, 9.29077721}},

          {{5.80813217, 5.95706034},
          {4.77996397, 6.56961155}}} });

      dinput_trans.resize(convInputTransDims);
      dinput_trans.setValues({ {{{2.91677380, 2.73592329},
          {2.62976909, 2.75515223}},

         {{2.19274926, 2.83505154},
          {3.00601459, 3.01020718}},

         {{2.26319432, 1.77781570},
          {3.71447039, 2.46540880}},

         {{3.08904123, 2.42187691},
          {3.27424932, 2.78188133}},

         {{1.85823214, 1.80664134},
          {2.71673369, 2.64089990}}},


        {{{3.29922366, 4.25927830},
          {2.05819654, 3.23371601}},

         {{2.90198326, 3.55102706},
          {1.90222204, 4.38825464}},

         {{2.41820097, 2.51685834},
          {2.40409303, 2.82580304}},

         {{2.96021843, 2.86446786},
          {2.45830083, 3.17606950}},

         {{2.20089340, 2.10514307},
          {1.74736750, 3.37544537}}} });
    }

    const array<Index, 4> dims = { 2, 3, 4, 4 }, kernelDims = { 5, 3, 3, 3 }, convOutDims = { 2, 5, 4, 4 }, convInputTransDims = { 2, 5, 2, 2 };
    const int padding = 1, dilation = 1;
    DeviceTensor<float, 4, Device_> convLoss, dweight, dinput, output, input_trans, dinput_trans, dweight_trans, convLossTrans, output_trans, weights;

  };

}