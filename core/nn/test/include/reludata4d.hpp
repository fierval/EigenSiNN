#pragma once

#include <device/device_tensor.hpp>

using namespace Eigen;
using namespace EigenSinn;

namespace EigenSinnTest {

  template <typename Device_, int Layout = ColMajor>
  class ReluData4d {

  public:
    ReluData4d() {

    }

    void init() {
      input.resize(dims);
      reluOutput.resize(dims);
      leakyReluOutput.resize(dims);
      dreluInput.resize(dims);
      dleakyReluInput.resize(dims);

      input.setValues({ {{{ 0.38472944,  0.67100579,  0.03045433,  0.39088044},
          {-0.02941556,  0.51034510,  0.52840817, -0.43537331},
          { 1.71949136, -0.23717950,  1.50586390, -1.02104580},
          { 0.53190005, -0.04962196,  1.33953464,  0.29301396}},

         {{ 1.77993762,  0.44098231,  0.81408805,  1.62604535},
          {-1.04019880,  1.37164009, -0.87952030, -0.71953881},
          {-0.54486942, -0.19437183,  0.39086488,  1.35216546},
          { 1.31791282, -0.71102488,  1.55235302, -0.74023443}},

         {{-0.14867811,  1.24637282, -0.77046263,  0.62799633},
          {-0.55567366,  0.59710985,  0.33713144,  1.19386315},
          { 0.80435932, -0.67679268, -1.53811979, -0.79009098},
          {-0.10832246, -0.04866752, -0.31269163, -0.85104209}}},


        {{{ 1.72139478, -0.59459746,  1.57452548, -0.66327924},
          { 0.21450450, -0.50060529, -0.99926287, -0.38327205},
          {-0.47455615, -2.80508518, -0.02873498,  0.35894939},
          { 0.22325756, -0.30368480, -1.16745281, -0.94114941}},

         {{-1.86748254, -0.14000152,  1.27949846,  0.54329556},
          {-0.13073179, -0.65514821,  1.25739598,  2.37016654},
          {-0.98691112, -0.01273805,  0.53872246,  0.51280230},
          { 0.57073760,  0.66659141,  1.19404614, -1.12505651}},

         {{ 0.68421668,  0.51698166,  0.64946383,  0.73839247},
          {-0.56877238, -0.08002367,  0.20858972, -0.03780154},
          {-0.27581626, -0.22956057, -0.10908085, -0.28334469},
          {-1.66577935, -2.25190639,  0.76427883,  2.07678223}}} });

      reluOutput.setValues({ {{{0.38472944, 0.67100579, 0.03045433, 0.39088044},
          {0.00000000, 0.51034510, 0.52840817, 0.00000000},
          {1.71949136, 0.00000000, 1.50586390, 0.00000000},
          {0.53190005, 0.00000000, 1.33953464, 0.29301396}},

         {{1.77993762, 0.44098231, 0.81408805, 1.62604535},
          {0.00000000, 1.37164009, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.39086488, 1.35216546},
          {1.31791282, 0.00000000, 1.55235302, 0.00000000}},

         {{0.00000000, 1.24637282, 0.00000000, 0.62799633},
          {0.00000000, 0.59710985, 0.33713144, 1.19386315},
          {0.80435932, 0.00000000, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.00000000, 0.00000000}}},


        {{{1.72139478, 0.00000000, 1.57452548, 0.00000000},
          {0.21450450, 0.00000000, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.00000000, 0.35894939},
          {0.22325756, 0.00000000, 0.00000000, 0.00000000}},

         {{0.00000000, 0.00000000, 1.27949846, 0.54329556},
          {0.00000000, 0.00000000, 1.25739598, 2.37016654},
          {0.00000000, 0.00000000, 0.53872246, 0.51280230},
          {0.57073760, 0.66659141, 1.19404614, 0.00000000}},

         {{0.68421668, 0.51698166, 0.64946383, 0.73839247},
          {0.00000000, 0.00000000, 0.20858972, 0.00000000},
          {0.00000000, 0.00000000, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.76427883, 2.07678223}}} });


      leakyReluOutput.setValues({ {{{ 3.84729445e-01,  6.71005785e-01,  3.04543301e-02,  3.90880436e-01},
          {-2.94155616e-04,  5.10345101e-01,  5.28408170e-01, -4.35373280e-03},
          { 1.71949136e+00, -2.37179501e-03,  1.50586390e+00, -1.02104582e-02},
          { 5.31900048e-01, -4.96219553e-04,  1.33953464e+00,  2.93013960e-01}},

         {{ 1.77993762e+00,  4.40982312e-01,  8.14088047e-01,  1.62604535e+00},
          {-1.04019875e-02,  1.37164009e+00, -8.79520271e-03, -7.19538797e-03},
          {-5.44869388e-03, -1.94371829e-03,  3.90864879e-01,  1.35216546e+00},
          { 1.31791282e+00, -7.11024879e-03,  1.55235302e+00, -7.40234414e-03}},

         {{-1.48678105e-03,  1.24637282e+00, -7.70462630e-03,  6.27996325e-01},
          {-5.55673661e-03,  5.97109854e-01,  3.37131441e-01,  1.19386315e+00},
          { 8.04359317e-01, -6.76792674e-03, -1.53811974e-02, -7.90090952e-03},
          {-1.08322455e-03, -4.86675184e-04, -3.12691624e-03, -8.51042103e-03}}},


        {{{ 1.72139478e+00, -5.94597450e-03,  1.57452548e+00, -6.63279230e-03},
          { 2.14504495e-01, -5.00605255e-03, -9.99262836e-03, -3.83272045e-03},
          {-4.74556116e-03, -2.80508511e-02, -2.87349802e-04,  3.58949393e-01},
          { 2.23257557e-01, -3.03684804e-03, -1.16745280e-02, -9.41149425e-03}},

         {{-1.86748244e-02, -1.40001520e-03,  1.27949846e+00,  5.43295562e-01},
          {-1.30731787e-03, -6.55148178e-03,  1.25739598e+00,  2.37016654e+00},
          {-9.86911077e-03, -1.27380496e-04,  5.38722456e-01,  5.12802303e-01},
          { 5.70737600e-01,  6.66591406e-01,  1.19404614e+00, -1.12505648e-02}},

         {{ 6.84216678e-01,  5.16981661e-01,  6.49463832e-01,  7.38392472e-01},
          {-5.68772340e-03, -8.00236652e-04,  2.08589718e-01, -3.78015393e-04},
          {-2.75816256e-03, -2.29560561e-03, -1.09080854e-03, -2.83344672e-03},
          {-1.66577939e-02, -2.25190632e-02,  7.64278829e-01,  2.07678223e+00}}} });


      dreluInput.setValues({ {{{0.04538226, 0.95949411, 0.50452268, 0.59602135},
          {0.00000000, 0.73222357, 0.07335120, 0.00000000},
          {0.90876633, 0.00000000, 0.24576986, 0.00000000},
          {0.29745585, 0.00000000, 0.62964255, 0.36631453}},

         {{0.50406832, 0.42415136, 0.34337270, 0.72482306},
          {0.00000000, 0.96129739, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.47089547, 0.82289129},
          {0.63725311, 0.00000000, 0.54370487, 0.00000000}},

         {{0.00000000, 0.75999165, 0.00000000, 0.40320259},
          {0.00000000, 0.10842186, 0.55331987, 0.58271384},
          {0.67342269, 0.00000000, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.00000000, 0.00000000}}},


        {{{0.61419797, 0.00000000, 0.52509171, 0.00000000},
          {0.38709599, 0.00000000, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.00000000, 0.93618810},
          {0.64560336, 0.00000000, 0.00000000, 0.00000000}},

         {{0.00000000, 0.00000000, 0.81256318, 0.98481309},
          {0.00000000, 0.00000000, 0.87681556, 0.37505645},
          {0.00000000, 0.00000000, 0.46080470, 0.09901488},
          {0.24049366, 0.78823119, 0.09643930, 0.00000000}},

         {{0.92674822, 0.49461865, 0.82311010, 0.50724411},
          {0.00000000, 0.00000000, 0.53645664, 0.00000000},
          {0.00000000, 0.00000000, 0.00000000, 0.00000000},
          {0.00000000, 0.00000000, 0.52929527, 0.41473496}}} });

      dleakyReluInput.setValues({ {{{4.53822613e-02, 9.59494114e-01, 5.04522681e-01, 5.96021354e-01},
          {7.47904647e-03, 7.32223570e-01, 7.33511969e-02, 8.56075063e-03},
          {9.08766329e-01, 4.70806751e-03, 2.45769858e-01, 5.90512156e-03},
          {2.97455847e-01, 9.87739209e-03, 6.29642546e-01, 3.66314530e-01}},

         {{5.04068315e-01, 4.24151361e-01, 3.43372703e-01, 7.24823058e-01},
          {4.60689049e-03, 9.61297393e-01, 6.27657585e-03, 2.70293653e-03},
          {3.54582607e-03, 3.86532955e-03, 4.70895469e-01, 8.22891295e-01},
          {6.37253106e-01, 2.96716276e-03, 5.43704867e-01, 8.72114487e-03}},

         {{8.50182772e-03, 7.59991646e-01, 1.55919848e-03, 4.03202593e-01},
          {7.49643194e-03, 1.08421862e-01, 5.53319871e-01, 5.82713842e-01},
          {6.73422694e-01, 7.49216042e-03, 9.66040045e-03, 2.66021839e-03},
          {5.30139450e-03, 9.82813165e-03, 4.36642766e-03, 7.67307729e-03}}},


        {{{6.14197969e-01, 8.45840480e-03, 5.25091708e-01, 1.80941937e-03},
          {3.87095988e-01, 2.54138885e-03, 7.45168747e-03, 2.70061358e-03},
          {7.20857177e-03, 8.45892914e-03, 6.23121718e-03, 9.36188102e-01},
          {6.45603359e-01, 6.13160199e-03, 9.61586647e-03, 9.24827531e-03}},

         {{1.13590772e-03, 8.48372187e-03, 8.12563181e-01, 9.84813094e-01},
          {3.64371529e-03, 1.08389079e-03, 8.76815557e-01, 3.75056446e-01},
          {5.42370079e-04, 6.64777728e-03, 4.60804701e-01, 9.90148783e-02},
          {2.40493655e-01, 7.88231194e-01, 9.64393020e-02, 7.73577858e-03}},

         {{9.26748216e-01, 4.94618654e-01, 8.23110104e-01, 5.07244110e-01},
          {4.30912664e-03, 6.49983669e-03, 5.36456645e-01, 6.94361608e-03},
          {1.84986580e-04, 2.29246914e-03, 9.62535944e-03, 9.96736437e-03},
          {9.38736193e-04, 8.60514957e-03, 5.29295266e-01, 4.14734960e-01}}} });
    }

  
    const array<Index, 4> dims = { 2, 3, 4, 4 };
    const float leaky_thres = 1e-2;
    DeviceTensor<float, 4, Device_, Layout> input, reluOutput, leakyReluOutput, dreluInput, dleakyReluInput;
  };

}